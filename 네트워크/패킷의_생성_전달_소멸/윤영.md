## 패킷의 생성, 전달, 소멸

패킷을 택배로 비유하여 생각해보자.

![스크린샷 2023-12-13 오후 4.52.34.png](https://github.com/Heo-y-y/development-blog/assets/112863029/a6fc7751-b36a-4f5e-8b67-10520d5cfb95)

그림에 보이는 남자가 여자한테 책을 보내려고 한다. 그러면 보내려는 책을 여자에게 전달하겠다는 것이 하나의 목표인데, 그 목적을 달성하기 위해서 수단을 강구해야 할 것이다. 물론 자신이 직접 가지고 가도 되겠지만, 택배로 보낸다고 가정해보자.

1. 제일 먼저 책을 준비해야 한다.
2. 책을 박스에 포장하여 송장을 붙인다.
3. 택배 기사가 운송 차량을 가지고 가지고 올텐데 이때 남자가 보내는 택배 뿐만이 아니라 다른 사람들의 택배도 운송 차량에 있을 것이다. 남자는 기사가 이후에 어디로 가는지도 알지 못한다.
4. 이후에는 알아서 물류체계를 타고 여자에게 책이 전달될 것이다.

여기서 중요한게 만약 여자가 혼자 사는 것이 아니라 가족과 같이 산다고 가정해보자. 하지만 남자는 송장을 통하여 주소와 받는 사람의 이름을 적었다. 송장 덕분에 남자가 개입하지 않아고, 안전하게 여자의 집까지 도착하고 같이 사는 가족들이 여자의 택배를 안전하게 전달하거나, 여자 본인이 직접 받을 것이다.

- 그러면 위 예시를 이제는 네트워크 적으로 풀어보자.

남자와 여자는 프로세스이다. 그리고 어느 프로세스가 책이다. 즉, 어떤 정보 또는 데이터라고 한다. 남자는 데이터를 여자에게 송신해야 한다.

그러면 데이터를 택배 즉, 패킷으로 만든다. 위에서 택배 기사는 게이트웨이가 된다. 그러면 게이트웨이는 네트워크 체계를 타고 라우팅을 한다. 그러면 이때 IP v4의 주소를 보고 Host인 여자한테 전달된다.

호스트까지 전달되면 다음에는 이름을 보고 해당 Host 내부에서 어떤 프로세스인지 선택해서 데이터를 준다. 이때 이름은 다른 말로 Port 번호가 된다.

구체적으로 예를 들면,

![스크린샷2 2023-12-13 오후 5 12 41](https://github.com/Heo-y-y/development-blog/assets/112863029/dc8a6689-6a8b-400d-973c-eac48ebd0340)

어떤 프로세스가 데이터를 인터넷으로 전달을 하려고 한다. 그림에서 프로세스 바로 밑에 인터페이스가 존재하는데, **인터페이스**는 **커널에 있는 TCP IP를 추상화한 인터페이스**이다. 이것을 소켓이라고 한다. 데이터를 해당 File에 Send한다.

그러면 TCP를 만나는데, **Header와 Payload 형식으로 Segment 화** 한다. IP에서도 마찬가지이다. 마지막에는 Frame Header가 붙는다.

감싼 상태로 타고 나가면 Access 스위치를 만나서 게이트웨이를 타고 인터넷으로 나간다.

**참고 자료**
- <https://www.inflearn.com/course/lecture?courseSlug=%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%ED%95%B5%EC%8B%AC%EC%9D%B4%EB%A1%A0-%EA%B8%B0%EC%B4%88&unitId=126824>
